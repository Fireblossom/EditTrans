encoded as qubits. Therefore, the quantum source node can transmit information to the quantum destination node using entangled pairs. When the source node and the destination node are distant from each other, remote entanglement connections are established according to the assigned routing. Intermediate quantum nodes, known as quantum repeaters, connect source and destination nodes using entanglement swapping, which involves joint Bell state measurements, to create a remote entanglement connection [6]. Therefore, a critical challenge for constructing quantum networks at a large scale is the efficient utilization of entangled pairs and the identification of optimal routing strategies for managing massive entanglement connections. 

Meanwhile, maintaining Entanglement fidelity is crucial to ensure high-quality remote entanglement connections, as the noise in the system [8] may prevent quantum repeaters from producing entangled pairs with the desired fidelity. Low-fidelity entangled pairs can adversely impact the quality of services offered by quantum applications [10]. For example, when the fidelity of entangled pairs falls below the quantum bit error rate (BER) in quantum cryptographic protocols, it can lead to the degradation of the security of key distribution [11]. Fortunately, the entanglement purification techniques [12]â€“[14] can improve the fidelity of entangled pairs by using additional entangled pairs. These techniques utilize multiple entangled pairs to combine them in various ways to increase the fidelity of the final purified entangled pair, such as entanglement distillation, quantum error correction, and decoherence-free subspaces. However, determining the optimal number of additional entangled pairs required by the entanglement purification technique to meet the uncertain requirements of fidelity values needed by quantum applications is challenging and has been overlooked in the literature. 

To overcome the challenges discussed above, in this paper, we propose an entangled pair and qubit resource management model in QCC. We focus on entangled pair resource allocation and fidelity-guaranteed entanglement routing in quantum networks, together with qubit resource allocation for quantum applications on quantum computers of the QCC providers. Specifically, we formulate the two-stage stochastic programming model to determine the optimal number of entangled pairs and the optimal number of qubits that can fulfill all requests from multiple quantum source nodes (i.e., users) and quantum destination nodes (i.e., providers). In the optimization problem, the uncertainties of fidelity requirements, the number of qubits, and the waiting time for quantum applications are taken into consideration. In addition, we apply the Benders decomposition algorithm to reduce both the complexity and execution time of the problem. The goal of the proposed model is to make optimal decisions for quantum applications in minimizing 