Despite their superficial similarity to the classical model, both (16) and (17) are numerically intractable to solve directly. Physically, the problem amounts to solving for the dynamics of an entire _ quantum field_ , where each field degree of freedom (i.e., mode) occupies a bosonic Fock space. Even if we discretize the field to \(M\) modes and truncate the Fock space of each mode to \(D\) dimensions (i.e., allowing at most \(D-1\)photons per mode), the quantum state of the field lives in a \(D^{M}\)-dimensional (Hilbert) space, upon which operators such as  \(\hat{H}_{\text{3wm}}\)\(\hat{H}_{\text{3wm}}\) and \(\hat{H}_{\text{lin}}\)\(\hat{H}_{\text{lin}}\) act. A typical discretization of the classical field \(\psi(z)\)in the NSLE might employ \(M=$1024$\)points, but even just allowing one photon per mode at \(D=2\), we have, at least without the use of sophisticated model reduction techniques, a \(2^{1024}\)-dimensional problem! 

The situation becomes greatly simplified, however, if we are able to focus our attention solely on the Gaussian moments of the state, namely the mean \(\langle\hat{\psi}_{z}\rangle\)(corresponding to an \(M\)-dimensional vector when discretized) and the covariances \(\langle\delta\hat{\psi}_{z}\delta\hat{\psi}_{z^{\prime}}\rangle\)and \(\langle\delta\hat{\psi}^{\dagger}_{z}\delta\hat{\psi}_{z^{\prime}}\rangle\)(each corresponding to an \(M\times M\) matrix). Thus, in a Gaussian framework, the numerical problem of solving for the quantum noise dynamics becomes \(\mathcal{O}(M^{2})\)-dimensional. As a result, our nonlinear Gaussian-state model has access to the same highly efficient numerical techniques employed by classical pulse propagation techniques, including the use of split-step methods based on the fast Fourier transform (FFT) and massively parallel computation on graphics processing units (GPUs). Specifically, just as the cost of evolving the field over one time step for the classical NLSE is well known to be limited by FFT to \(\mathcal{O}(M\log M)\), our method does the same for the full Gaussian moments of the field with only cost \(\mathcal{O}(M^{2}\log M)\). This makes our method a natural generalization of the classical split-step Fourier (SSF) method, and we therefore refer to our numerical approach, when applied to the problem of ultrafast pulse proagation, as a _ nonlin-_ _ear Gaussian-state SSF (GSSF) method_ . In this work, we perform all GSSF simulations using a GPU implementation of the RK4IP split-step method [61] via the high-level Julia package CUDA.jl [62]. 

As in Sec. II, the key contribution of this work is to prescribe nonlinear equations of motion for the mean and covariance of the multimode field  \(\hat{\psi}_{z}\)\(\hat{\psi}_{z}\), making only the assumption that the state is Gaussian. Due to the split-step nature of the GSSF method, we have, as in the classical SSF, the additional requirement of applying the dispersive step due to  \(\hat{H}_{\text{lin}}\)\(\hat{H}_{\text{lin}}\), but because (17b) is linear, we straightforwardly have 

\[\mathrm{i}\,\mathrm{d}\mathcal{D}\langle\hat{\Psi}_{k}\rangle=\Omega(k)\langle \hat{\Psi}_{k}\rangle\,\mathrm{d}t\] (18)  

for the mean, and, for the covariances, 

\[\mathrm{i}\,\mathrm{d}\mathcal{D}\langle\delta\hat{\Psi}_{k} \delta\hat{\Psi}_{k^{\prime}}\rangle =\big{\lparen}\Omega(k^{\prime})+\Omega(k)\big{\rparen}\langle \delta\hat{\Psi}_{k}\delta\hat{\Psi}_{k^{\prime}}\rangle\,\mathrm{d}t\] (19a) \[\mathrm{i}\,\mathrm{d}\mathcal{D}\langle\delta\hat{\Psi}^{\dagger }_{k}\delta\hat{\Psi}_{k^{\prime}}\rangle =\big{\lparen}\Omega(k^{\prime})-\Omega(k)\big{\rparen}\langle \delta\hat{\Psi}^{\dagger}_{k}\delta\hat{\Psi}_{k^{\prime}}\rangle\,\mathrm{d}t,\] (19b)  

which can be analytically integrated. Thus, the nontrivial part is deriving the equations of motion in the nonlinear (or real-space) step, but because (17a) is local in \(z\) (i.e., the differential evolution of  \(\hat{\psi}_{z}\)\(\hat{\psi}_{z}\) is decoupled from that of  \(\hat{\psi}_{z^{\prime}}\)\(\hat{\psi}_{z^{\prime}}\) for \(z\neq z^{\prime}\)), we can simply make use of the same methods already presented in Sec. II for the single-mode case, making sure to carefully track the multimode indices in the covariances. For the mean, we have a modified version of the classical nonlinear step, 

\[\mathrm{i}\,\dot{\mathcal{N}}\langle\hat{\psi}_{z}\rangle=\langle \hat{\psi}^{\dagger}_{z}\rangle\langle\hat{\psi}_{z}\rangle^{2}+2\langle\hat{ \psi}_{z}\rangle\langle\delta\hat{\psi}^{\dagger}_{z}\delta\hat{\psi}_{z} \rangle+\langle\hat{\psi}^{\dagger}_{z}\rangle\langle\delta\hat{\psi}_{z}^{2}\rangle,\] (20)  

where the last two terms are corrections due to coupling to the covariances. Then the equations of motion for the covariances are, after some algebra, 

\[\mathrm{i}\,\dot{\mathcal{N}} \langle\delta\hat{\psi}_{z}\delta\hat{\psi}_{z^{\prime}}\rangle= \langle\hat{\psi}_{z}^{2}\rangle\langle\delta\hat{\psi}_{z}^{\dagger}\delta \hat{\psi}_{z^{\prime}}\rangle+\langle\hat{\psi}_{z^{\prime}}^{2}\rangle \langle\delta\hat{\psi}_{z}\delta\hat{\psi}^{\dagger}_{z^{\prime}}\rangle\] \[\qquad{}+2\big{\lparen}\langle\hat{\psi}_{z}^{\dagger}\hat{\psi}_ {z}\rangle+\langle\hat{\psi}^{\dagger}_{z^{\prime}}\hat{\psi}_{z^{\prime}} \rangle\big{\rparen}\langle\delta\hat{\psi}_{z}\delta\hat{\psi}_{z^{\prime}}\rangle\] (21a) \[\mathrm{i}\,\dot{\mathcal{N}} \langle\delta\hat{\psi}_{z}^{\dagger}\delta\hat{\psi}_{z^{\prime} }\rangle=-\langle\hat{\psi}_{z}^{\dagger 2}\rangle\langle\delta\hat{\psi}_{z} \delta\hat{\psi}_{z^{\prime}}\rangle+\langle\hat{\psi}_{z^{\prime}}^{2}\rangle \langle\delta\hat{\psi}_{z}^{\dagger}\delta\hat{\psi}^{\dagger}_{z^{\prime}}\rangle\] \[\qquad{}-2\big{\lparen}\langle\hat{\psi}_{z}^{\dagger}\hat{\psi}_ {z}\rangle-\langle\hat{\psi}^{\dagger}_{z^{\prime}}\hat{\psi}_{z^{\prime}} \rangle\big{\rparen}\langle\delta\hat{\psi}_{z}^{\dagger}\delta\hat{\psi}_{z^{ \prime}}\rangle,\] (21b)  

where we use the shorthand notations \(\langle\hat{\psi}_{z}^{2}\rangle=\langle\hat{\psi}_{z}\rangle^{2}+\big{\langle }\delta\hat{\psi}_{z}^{2}\big{\rangle}\), \(\langle\hat{\psi}^{\dagger}_{z}\hat{\psi}_{z}\rangle=|\langle\hat{\psi}_{z} \rangle|^{2}+\langle\delta\hat{\psi}^{\dagger}_{z}\delta\hat{\psi}_{z}\rangle\), and \(\langle\delta\hat{\psi}_{z}\delta\hat{\psi}^{\dagger}_{z^{\prime}}\rangle= \langle\delta\hat{\psi}^{\dagger}_{z^{\prime}}\delta\hat{\psi}_{z}\rangle+ \delta(z-z^{\prime})\). (Note that the latter Dirac delta function is converted into a Kronecker delta upon discretizing of the continuum field following Appendix B.) 

To summarize, the GSSF equations of motion describing the propagation of both the mean field and the Gaussian quantum noise in \(\chi^{(3)}\)waveguides are given by (18), (19), (20), and (21). 

### Example: Soliton noise dynamics 

As a first demonstration, we apply GSSF to study propagation of a canonical Kerr soliton in a \(\chi^{(3)}\)nonlinear waveguide. Classically, the Kerr soliton is a perfectly stable waveform arising from the balance of linear dispersion with nonlinear self-phase modulation, and quantum noise around this classical solution, in the form of so-called “Kerr squeezing”, has been extensively studied in quantum optics [63–66]. Conventionally, such studies use a linearized treatment [42–44] which, as discussed in Sec. II, presupposes a separation of energy scales between dynamics of the mean field and the quantum noise: The former occurs very quickly and is first solved using classical SSF, while the latter is treated as simple linear perturbations that follow the classical solution. As we show, however, nonlinear dynamics captured by our GSSF method can have a qualitative impact on Kerr squeezing in the regime of small soliton amplitude (i.e., under stronger optical nonlinearities). 

The Kerr soliton can be canonically treated using the \(\chi^{(3)}\)nonlinear waveguide propagation model (15), and we assume a quadratic dispersion where \(\Omega(k)=\frac{1}{2}\omega^{\prime\prime}k^{2}\). In this case, the mean-field limit of (16) (i.e., the classical NLSE) supports the well known sech-soliton solution [60] 