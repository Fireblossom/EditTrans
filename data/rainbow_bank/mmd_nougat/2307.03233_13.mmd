error probability \(35p^{3}\), these can then be used in another 15-to-1 protocol to generate a single \(\left|T\right\rangle\)state with error probability \(35(35p^{3})^{3}=1,500,625p^{9}\). The cost with these protocols is that reducing the error probability requires additional resources in terms of both time and number of qubits. A summary of several protocols and their associated costs is provided in Ref. [19]. 

When choosing a suitable protocol, there are multiple factors that we need to consider. First, we need to consider the overall logical failure probability from faulty \(\left|T\right\rangle\)state generation. This means that if our logical circuit uses \(m\)\(T\) gates – and therefore requires \(m\)\(\left|T\right\rangle\)states – we need to choose a probability of distilled state failure \(p_{\text{dist}}\) such that \(m\times p_{\text{dist}}\) is within our error bounds. 

The second aspect we need to consider is the time required to generate each \(\left|T\right\rangle\)state. In order to avoid logical qubits remaining idle as we wait for \(\left|T\right\rangle\)states to be generated, we need to ensure that \(\left|T\right\rangle\)states are generated fast enough that they are available as and when they are needed. This depends on both the number of QEC rounds required to generate the \(\left|T\right\rangle\)states, but also the number of QEC rounds required to implement these logical operations. If we implement Clifford gates directly as described in Section III B, the circuit primarily consists of alternating sequences of Hadamard gates, which take \(3d+4\)QEC rounds, and \(T\)-like gates, which take between \(d+1\)and \(5d/2+4\)QEC rounds, depending on whether or not an \(S\) gate correction is required. This means that when implementing Clifford gates directly, a \(\left|T\right\rangle\)state needs to be produced at least once every \(4d+5\)QEC rounds. In comparison, when Clifford operations have been moved through the circuit as described in Section III C, the only operations required are a single joint Pauli measurement and a single \(X\) basis measurement, meaning that a \(\left|T\right\rangle\)state must be produced every \(d+1\)QEC rounds. If a single distillation protocol cannot generate states fast enough, multiple instances of the protocol can be run in parallel to generate states more frequently, at the cost of increasing the number of physical qubits [12]. As we show in Appendix D, up to four factories can be placed around the two corners at the top of the routing space. It is possible to add even more factories beyond these four, but doing so could require additional space for routing and storage of \(\left|T\right\rangle\)states. On the other hand, if a logical \(\left|T\right\rangle\)state can be generated faster than required, additional storage space is required to protect the state from errors while it waits to be consumed, which can be included as part of the routing space estimates. 

### Estimating code distance 

To reduce the probability of a logical error occurring on one of our logical qubits, we can tweak the code distance \(d\). A higher distance will reduce the probability of getting a sequence of physical errors which lead to a logical error, but comes at the cost of increasing both the number of physical qubits per logical qubit, and the number of QEC rounds per logical operation. In the case of the surface code, the probability of a logical error on a single logical qubit per code cycle assuming a depolarising noise model can be estimated as 

\[p_{L}(p,d)=0.1(100p)^{(d+1)/2},\] (25)  

where \(p\) is the physical error probability [10, 12, 53]. For the purpose of this application, we want to choose a sufficiently high \(d\) that the probability of a logical error occurring on any qubit during any QEC round is within our error bound. We use Equation 25 to approximate (a) Initial layout. 

(b) Pauli \(Y\otimes X\otimes Z\) measurement. 

(c) Pauli \(Z\otimes Y\otimes Z\) measurement. 

FIG. 17: Layout of logical patches for implementing joint Pauli measurements. In (17a), the two qubits used in the logical circuit are at the bottom, and an auxiliary qubit is initialised in the \(\left|T\right\rangle\)state at the top. Example joint measurements required for implementing \(\pi/4\)Pauli \(Y\otimes X\) and \(Z\otimes Y\) operations are presented in (17b) and (17c), respectively. The auxiliary \(\left|T\right\rangle\)state is always measured in the \(Z\) basis as part of the joint measurement. Green dots represent stabiliser measurements whose outcomes produce the result of the joint logical Pauli measurement. Twist defects are presented in yellow. Arrows between neighbouring measurement qubits show extended connectivity than what is required for the methods presented in Section III B. 